# Alcohol_Substance_GWAS_Magma_Comparison
Comparative MAGMA/FUMA analysis of alcohol use and substance use GWAS identifying shared and trait-specific genes and pathways. Results highlight convergence on synaptic, transcriptional, and regulatory biology alongside alcohol-specific metabolic mechanisms.

## MAGMA / FUMA Gene-Level and Pathway Overlap Analysis

This repository documents a comparative analysis of alcohol-related and substance use–related genome-wide association studies (GWAS) using gene-level and pathway-level results generated by **MAGMA** via the **FUMA** platform.

The goal of this analysis is to characterize **shared and distinct genetic architecture** between alcohol use and broader substance use phenotypes by identifying:

- genes uniquely associated with alcohol-related traits  
- genes uniquely associated with substance use traits  
- genes shared across both phenotypes, indicating common biological mechanisms  

Gene-level overlap analyses were followed by **pathway-level MAGMA Gene Set Analysis (GSA)** to assess convergence on biological processes and to identify trait-specific pathway enrichment.

This work is intended as a **comparative, hypothesis-generating analysis**, providing biological context for shared addiction liability while highlighting mechanisms specific to alcohol metabolism versus broader reward and reinforcement circuitry.

---

## Data Sources

- **Alcohol GWAS (2024):**  
  Genome-wide association study of alcohol consumption and alcohol-related problems from the Alcohol-4-Factor (ALC4) consortium. This GWAS includes data from cohorts participating in the **Psychiatric Genomics Consortium (PGC)**. Summary statistics were processed for downstream analyses using MAGMA via the FUMA platform.

- **Substance Use GWAS (2023):**  
  Genome-wide association study of substance use–related phenotypes representing broader liability to substance use beyond alcohol alone. This GWAS includes data generated by cohorts participating in the **Psychiatric Genomics Consortium (PGC)**.

- **Gene-level and pathway analysis:**  
  Gene-based association testing and gene-set enrichment analyses were performed using **MAGMA** (v1.10) as implemented in the **FUMA** platform. SNP-to-gene mapping and linkage disequilibrium estimation used the **1000 Genomes Phase 3 European reference panel**.

- **Significance threshold:**  
  Gene-level associations were considered significant at a nominal threshold of **p < 1×10⁻³**, chosen as an exploratory but conservative cutoff to reduce noise while retaining biological signal for comparative analyses.

## Methods

### Gene-Level Analysis

Gene-based association testing was performed using **MAGMA** as implemented in the **FUMA SNP2GENE pipeline**, which aggregates SNP-level association statistics into gene-level Z-scores while accounting for linkage disequilibrium using the **1000 Genomes Phase 3 European reference panel**.

- Genes were considered significant at **p < 1×10⁻³**
- This threshold was chosen as exploratory but sufficiently stringent to reduce noise
- Gene lists were extracted directly from MAGMA gene-level output files generated by FUMA

### Overlap Analysis

Significant gene lists for alcohol and substance use were compared using standard set operations to identify:

- shared (overlapping) genes  
- alcohol-only genes  
- substance-only genes  

Overlap proportions were calculated relative to the total number of significant genes for each phenotype.

### Terminal Commands Used

### Terminal Commands Used

```bash
# sort gene lists
sort alcohol_sig_genes_p1e3.txt > alcohol_sorted.txt
sort substance_sig_genes_p1e3.txt > substance_sorted.txt

# overlapping genes
comm -12 alcohol_sorted.txt substance_sorted.txt > overlap_genes_p1e3.txt

# alcohol-only genes
comm -23 alcohol_sorted.txt substance_sorted.txt > alcohol_only_genes_p1e3.txt

# substance-only genes
comm -13 alcohol_sorted.txt substance_sorted.txt > substance_only_genes_p1e3.txt

# count results
wc -l alcohol_sorted.txt substance_sorted.txt overlap_genes_p1e3.txt \
      alcohol_only_genes_p1e3.txt substance_only_genes_p1e3.txt
## Gene-Level Results

### Gene Counts

| Category | Count |
|---------|------:|
| Alcohol-associated genes | 197 |
| Substance use–associated genes | 364 |
| Shared (overlapping) genes | 70 |
| Alcohol-only genes | 127 |
| Substance-only genes | 294 |
| Total unique genes | 491 |

**Arithmetic checks**

- 127 + 70 = 197 (alcohol)  
- 294 + 70 = 364 (substance)  
- 127 + 294 + 70 = 491 (union)  

All counts are internally consistent.

---

## Interpretation of Gene-Level Overlap

### Overlapping Genes (n = 70)

These genes likely represent **shared genetic liability** between alcohol use and substance use, reflecting common biological mechanisms including:

- core addiction biology  
- reward and dopaminergic pathways  
- shared psychiatric vulnerability  

**Relative overlap proportions**

- ~36% of alcohol-associated genes overlap with substance use  
- ~19% of substance-associated genes overlap with alcohol  

This asymmetry suggests that **alcohol-related genetic risk is more embedded within broader substance-use liability** than vice versa.

---

### Alcohol-Only Genes (n = 127)

Genes uniquely associated with alcohol phenotypes likely reflect:

- alcohol-specific metabolism and pharmacokinetics  
- drinking behaviors distinct from general addiction liability  
- biological pathways specific to ethanol exposure  

---

### Substance-Only Genes (n = 294)

Genes uniquely associated with substance use likely reflect:

- broader addiction vulnerability  
- polysubstance liability  
- non–alcohol-specific reward, impulsivity, and reinforcement pathways  

---

## Pathway-Level Analysis (MAGMA GSA)

Pathway enrichment was assessed using **MAGMA Gene Set Analysis (GSA)** as implemented in FUMA across curated gene sets, including:

- Gene Ontology Biological Process (GOBP)  
- Gene Ontology Molecular Function (GOMF)  
- Gene Ontology Cellular Component (GOCC)  

### Pathway Counts

| Category | Count |
|---------|------:|
| Significant substance use pathways | 715 |
| Significant alcohol pathways | 918 |
| Shared pathways | 691 |
| Alcohol-only pathways | 227 |

- **96.6%** of substance use pathways were also significant for alcohol  
- Alcohol shows broader pathway enrichment, consistent with additional metabolic and systemic effects beyond shared neurobiological mechanisms

---

## Interpretation of Shared Pathway Enrichment

### Synaptic Structure and Neuronal Compartments

Representative pathways include:

- GOCC_POSTSYNAPSE  
- GOCC_DENDRITIC_TREE  
- GOCC_SOMATODENDRITIC_COMPARTMENT  
- GOCC_GLUTAMATERGIC_SYNAPSE  

These pathways implicate neuronal connectivity, synaptic structure, and excitatory glutamatergic signaling, supporting a shared neurobiological basis for alcohol and substance use liability.

**Key takeaway:** Shared genetic risk converges on synaptic architecture and excitatory neurotransmission.

---

### Transcription and Chromatin Regulation

Strongly overlapping pathways include:

- transcription regulator activity  
- sequence-specific DNA binding  
- chromatin and chromosome organization  
- RNA polymerase II–mediated transcription  

These pathways indicate that addiction risk operates through **broad regulatory control of neuronal gene expression**, consistent with polygenicity, developmental effects, and long-term neural plasticity.

**Key takeaway:** Shared risk is rooted in transcriptional and chromatin-level regulation rather than isolated drug-specific genes.

---

### Neurodevelopment and Signaling Modulation

Additional overlapping pathways reflect higher-level regulatory control of neuronal signaling and network-level processes rather than single molecular targets.

**Key takeaway:** Shared risk reflects altered regulation of neuronal signaling networks.

---

## Trait-Specific Pathway Enrichment

### Alcohol-Specific Pathways

Alcohol-only pathways are enriched for:

- metabolic and liver-related processes  
- alcohol dehydrogenase biology  
- peripheral physiology and liver–brain interactions  

**Interpretation:** Alcohol genetic risk combines neural vulnerability with metabolic handling of ethanol.

---

### Substance Use–Specific Pathways

Substance-only pathways emphasize:

- dopaminergic signaling  
- reward circuitry  
- intracellular signaling cascades  
- transcriptional programs linked to reinforcement learning  

**Interpretation:** Substance use liability is driven more by reward circuitry and behavioral reinforcement than by metabolism.

---

## Alcohol Dehydrogenase (ADH) Gene Family — GWAS Interpretation

| Gene | Primary Function | Role in Alcohol Biology | GWAS Signal Strength | Notes |
|------|------------------|------------------------|----------------------|-------|
| ADH1B | Ethanol → acetaldehyde | Primary determinant of metabolism speed | Very strong | Canonical alcohol gene |
| ADH4 | Ethanol oxidation | Heavy drinking and tolerance | Strong | Active at high ethanol |
| ADH7 | Ethanol metabolism | First-pass / CNS effects | Strong | Extrahepatic expression |
| ADH6 | Minor ethanol metabolism | Secondary contributor | Moderate | Biologically plausible |
| ADH1A | Ethanol metabolism | Redundant with ADH1B | Weak | Expected weak signal |
| ADH5 | Formaldehyde metabolism | Indirect | Weak–moderate | Likely LD-related |
| ADHFE1 | Hydroxyacid metabolism | Not ethanol-specific | None | Passenger gene |

##Conclusion

Alcohol and substance use GWAS share a large core of genetic risk involving neuronal synaptic structure, glutamatergic signaling, and transcriptional regulation. Alcohol additionally shows strong and biologically specific enrichment of ethanol-metabolizing genes and metabolic pathways, while substance use liability emphasizes broader reward circuitry and gene regulatory networks. Together, these results support a model in which shared addiction vulnerability reflects altered neuronal plasticity and gene regulation, with alcohol-specific genetic effects layered on top through metabolic biology.
